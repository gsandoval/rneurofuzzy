#!/usr/bin/env ruby
$LOAD_PATH.unshift(File.dirname(__FILE__) + '/../lib') unless $LOAD_PATH.include?(File.dirname(__FILE__) + '/../lib')
require "neurofuzzy"

patterns = [
    [1, 1, 1], [-1, 1, 1], [1, 1, -1], [-1, 1, -1],
    [1, -1, 1], [-1, -1, 1], [1, -1, -1], [-1, -1, -1]
]

expected = [
    [1, 0, 0, 0], [0, 1, 0, 0], [0, 0, 1, 0], [0, 0, 0, 1],
    [0, 0, 0, 1], [0, 0, 1, 0], [0, 1, 0, 0], [1, 0, 0, 0]
]

nn = Neurofuzzy::BackPropagationNetwork.new(3, 4, 5)
nn.trained_weights = [[-22.219372905868163, -21.148008476051146, -1.6559672218801866, 22.639376753653433], [-5.626830016168901, -21.034909263059046, 26.347306563739078, -7.296814043225734], [-20.45058850330793, 2.36179677660507, -21.135475383486593, 33.95613712206444], [-14.7960140207981, -14.43879066422483, 21.057407384694013, 15.657804717673777], [-13.31044154757554, 13.579624346018266, -26.105825483944322, 9.219788719703663], [664.2425574829492, 548.62812645834, 430.1931745181074, 569.4967096767925], [9.740731375252931, -10.65454687387292, -9.264211365220476, 6.638359531218907, -1.3428909090453993, -2.3403189370409336], [-4.647569982980213, -5.1409136792400085, 9.242375819525773, 2.1997639825546664, -14.236041277422983, -9.167779492345785], [2.127269620464985, 9.295039348711942, 7.227151333490514, -12.38386823248509, -0.43844550882207345, -2.1252768707441447], [-1.9621898553702832, 8.685922039414969, -8.667331177418527, 0.02114417426454335, 17.050641265103867, -5.458731549768212]]

patterns.zip(expected).each do |p, e|
  output = nn.classify(p).map {|c| c.round}
  puts "Input: #{p}, Expected: #{e}, Output: #{output}"
end